{"openapi":"3.1.0","info":{"title":"OryggiAI Chatbot","description":"Agentic AI Chatbot with RAG, Report Generation, and Action Execution","version":"1.0.0"},"paths":{"/health":{"get":{"summary":"Health Check","description":"Health check endpoint\nReturns application status","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint - redirects to tenant login page","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api":{"get":{"summary":"Api Info","description":"API information endpoint for developers","operationId":"api_info_api_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/auth/register":{"post":{"tags":["Authentication"],"summary":"Register a new tenant","description":"Register a new tenant (company/organization) with an owner account","operationId":"register_new_tenant_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantRegistrationRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegistrationResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/users":{"post":{"tags":["Authentication"],"summary":"Create a new user","description":"Create a new user within the current tenant (admin only)","operationId":"create_user_api_auth_users_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserRegistrationRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/api/auth/login":{"post":{"tags":["Authentication"],"summary":"User login","description":"Authenticate user and return access/refresh tokens","operationId":"login_api_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/refresh":{"post":{"tags":["Authentication"],"summary":"Refresh access token","description":"Get new access token using refresh token","operationId":"refresh_token_api_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/logout":{"post":{"tags":["Authentication"],"summary":"User logout","description":"Logout user and revoke refresh tokens","operationId":"logout_api_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"JWT":[]}]}},"/api/auth/me":{"get":{"tags":["Authentication"],"summary":"Get current user","description":"Get the currently authenticated user's profile","operationId":"get_current_user_profile_api_auth_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"JWT":[]}]},"put":{"tags":["Authentication"],"summary":"Update current user","description":"Update the currently authenticated user's profile","operationId":"update_current_user_profile_api_auth_me_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserUpdateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/api/auth/password/change":{"post":{"tags":["Authentication"],"summary":"Change password","description":"Change the current user's password","operationId":"change_user_password_api_auth_password_change_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordChangeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/api/auth/password/reset-request":{"post":{"tags":["Authentication"],"summary":"Request password reset","description":"Request a password reset email","operationId":"request_password_reset_api_auth_password_reset_request_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/password/reset":{"post":{"tags":["Authentication"],"summary":"Reset password","description":"Reset password using reset token","operationId":"reset_password_api_auth_password_reset_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PasswordResetConfirm"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/health":{"get":{"tags":["Authentication"],"summary":"Auth service health","description":"Check if the authentication service is healthy","operationId":"auth_health_check_api_auth_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/tenant/":{"get":{"tags":["Tenant Management"],"summary":"Get current tenant","description":"Get details of the current tenant","operationId":"get_current_tenant_api_tenant__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}}},"security":[{"JWT":[]}]},"put":{"tags":["Tenant Management"],"summary":"Update tenant","description":"Update the current tenant's settings (owner only)","operationId":"update_current_tenant_api_tenant__put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUpdate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/api/tenant/usage":{"get":{"tags":["Tenant Management"],"summary":"Get usage statistics","description":"Get usage statistics for the current tenant","operationId":"get_usage_statistics_api_tenant_usage_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUsageStats"}}}}},"security":[{"JWT":[]}]}},"/api/tenant/databases":{"get":{"tags":["Tenant Management"],"summary":"List database connections","description":"Get all database connections for the current tenant","operationId":"list_databases_api_tenant_databases_get","security":[{"JWT":[]}],"parameters":[{"name":"include_inactive","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Include Inactive"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DatabaseConnectionSummary"},"title":"Response List Databases Api Tenant Databases Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Tenant Management"],"summary":"Create database connection","description":"Add a new database connection (admin only)","operationId":"create_database_api_tenant_databases_post","security":[{"JWT":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenant/databases/{database_id}":{"get":{"tags":["Tenant Management"],"summary":"Get database connection","description":"Get details of a specific database connection","operationId":"get_database_api_tenant_databases__database_id__get","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Tenant Management"],"summary":"Update database connection","description":"Update a database connection (admin only)","operationId":"update_database_api_tenant_databases__database_id__put","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Tenant Management"],"summary":"Delete database connection","description":"Delete a database connection (admin only)","operationId":"delete_database_api_tenant_databases__database_id__delete","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}},{"name":"hard_delete","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Hard Delete"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenant/databases/{database_id}/test":{"post":{"tags":["Tenant Management"],"summary":"Test database connection","description":"Test connectivity to a database","operationId":"test_database_api_tenant_databases__database_id__test_post","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseTestResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenant/databases/test":{"post":{"tags":["Tenant Management"],"summary":"Test new database connection","description":"Test connectivity to a new database before saving","operationId":"test_new_database_api_tenant_databases_test_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionCreate"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseTestResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/api/tenant/databases/{database_id}/onboard":{"post":{"tags":["Tenant Management"],"summary":"Onboard database","description":"Start automatic onboarding for a database (admin only)","operationId":"onboard_database_api_tenant_databases__database_id__onboard_post","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}},{"name":"fewshot_count","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Fewshot Count"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenant/databases/{database_id}/onboard/status":{"get":{"tags":["Tenant Management"],"summary":"Get onboarding status","description":"Get the onboarding status for a database","operationId":"get_onboard_status_api_tenant_databases__database_id__onboard_status_get","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenant/users":{"get":{"tags":["Tenant Management"],"summary":"List tenant users","description":"Get all users in the current tenant","operationId":"list_users_api_tenant_users_get","security":[{"JWT":[]}],"parameters":[{"name":"include_inactive","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Include Inactive"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TenantUserSummary"},"title":"Response List Users Api Tenant Users Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Tenant Management"],"summary":"Create user","description":"Create a new user in the tenant (admin only)","operationId":"create_user_api_tenant_users_post","security":[{"JWT":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUserCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenant/users/{user_id}":{"get":{"tags":["Tenant Management"],"summary":"Get user","description":"Get details of a specific user","operationId":"get_user_api_tenant_users__user_id__get","security":[{"JWT":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Tenant Management"],"summary":"Update user","description":"Update a user in the tenant (admin only)","operationId":"update_user_api_tenant_users__user_id__put","security":[{"JWT":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUserUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantUserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Tenant Management"],"summary":"Delete user","description":"Delete a user from the tenant (admin only)","operationId":"delete_user_api_tenant_users__user_id__delete","security":[{"JWT":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string","title":"User Id"}},{"name":"hard_delete","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Hard Delete"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/query":{"post":{"tags":["Chat"],"summary":"Query Chatbot","description":"Process natural language query and return answer with conversation memory\n\n**Phase 3 Features:**\n- Session continuity across requests\n- Conversation storage in PostgreSQL\n- Background sync to ChromaDB for RAG\n\n**Example Request:**\n```json\n{\n    \"question\": \"How many employees joined in the last 30 days?\",\n    \"tenant_id\": \"default\",\n    \"user_id\": \"admin\",\n    \"user_role\": \"ADMIN\",\n    \"session_id\": \"session_admin_20250117_abc123\"\n}\n```\n\n**Example Response:**\n```json\n{\n    \"session_id\": \"session_admin_20250117_abc123\",\n    \"question\": \"How many employees joined in the last 30 days?\",\n    \"sql_query\": \"SELECT COUNT(*) FROM EmployeeMaster WHERE ...\",\n    \"answer\": \"5 employees joined in the last 30 days.\",\n    \"result_count\": 1,\n    \"tables_used\": [\"EmployeeMaster\"],\n    \"execution_time\": 0.523,\n    \"success\": true\n}\n```","operationId":"query_chatbot_api_chat_query_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatQueryRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatQueryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/index-schema":{"post":{"tags":["Chat"],"summary":"Index Schema","description":"Index database schema into vector store\n\nThis endpoint extracts database schema (tables, columns, relationships)\nand creates embeddings for RAG-based query generation.\n\n**When to use:**\n- After database schema changes\n- Initial setup\n- When query accuracy drops\n\n**Example Request:**\n```json\n{\n    \"force_reindex\": true\n}\n```\n\n**Example Response:**\n```json\n{\n    \"success\": true,\n    \"embeddings_count\": 1250,\n    \"tables_count\": 35,\n    \"message\": \"Schema indexed successfully\"\n}\n```","operationId":"index_schema_api_chat_index_schema_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SchemaIndexRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SchemaIndexResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/chat/schema-stats":{"get":{"tags":["Chat"],"summary":"Get Schema Stats","description":"Get vector store statistics\n\nReturns information about indexed schema:\n- Number of embeddings\n- Sample documents\n- Collection status\n\n**Example Response:**\n```json\n{\n    \"count\": 1250,\n    \"sample_ids\": [\"schema_EmployeeMaster\", \"column_EmployeeMaster_Ecode\", ...],\n    \"status\": \"healthy\"\n}\n```","operationId":"get_schema_stats_api_chat_schema_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/chat/mt/query":{"post":{"tags":["Chat"],"summary":"Multi Tenant Query","description":"Multi-tenant chat endpoint - uses authenticated user's tenant database\n\nThis endpoint requires JWT authentication and will use the tenant's\nconfigured database for queries.\n\n**Flow:**\n1. Authenticate user via JWT token\n2. Get user's tenant and default database\n3. Process query against tenant's database\n4. Return results with tenant isolation\n\n**Example Request:**\n```json\n{\n    \"question\": \"How many employees joined in the last 30 days?\",\n    \"database_id\": null,  // Uses default database\n    \"session_id\": null    // Auto-generated if not provided\n}\n```\n\n**Headers Required:**\n- Authorization: Bearer <jwt_token>","operationId":"multi_tenant_query_api_chat_mt_query_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MTChatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatQueryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/api/chat/mt/databases":{"get":{"tags":["Chat"],"summary":"Get Available Databases","description":"Get available databases for multi-tenant chat\n\nReturns list of databases the authenticated user can query.","operationId":"get_available_databases_api_chat_mt_databases_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"JWT":[]}]}},"/api/chat/reload-fewshot":{"post":{"tags":["Chat"],"summary":"Reload few-shot examples","description":"Reload few-shot examples from JSON file and rebuild FAISS index","operationId":"reload_fewshot_examples_api_chat_reload_fewshot_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/reports/generate":{"post":{"tags":["Reports"],"summary":"Generate Report","description":"Generate a PDF or Excel report from a natural language query\n\n**Phase 3 Feature:** Report Generation\n\n**Features:**\n- PDF and Excel report generation\n- RAG-enhanced SQL query generation\n- RBAC enforcement with data scoping\n- Automatic formatting and styling\n- Summary statistics (for numeric columns)\n\n**Example Request:**\n```json\n{\n    \"question\": \"Show me all employees in Engineering department\",\n    \"format\": \"pdf\",\n    \"user_id\": \"admin\",\n    \"user_role\": \"ADMIN\"\n}\n```\n\n**Example Response:**\n```json\n{\n    \"success\": true,\n    \"report_path\": \"./reports_output/report_20250117_143025.pdf\",\n    \"format\": \"pdf\",\n    \"rows_count\": 45,\n    \"execution_time_ms\": 1523.45,\n    \"question\": \"Show me all employees in Engineering department\",\n    \"sql_query\": \"SELECT * FROM EmployeeMaster WHERE Department = 'Engineering'\",\n    \"truncated\": false,\n    \"max_rows\": 10000\n}\n```","operationId":"generate_report_api_reports_generate_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReportGenerateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReportGenerateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/reports/download/{filename}":{"get":{"tags":["Reports"],"summary":"Download Report","description":"Download a generated report file\n\n**Path Parameters:**\n- filename: Name of the report file to download\n\n**Returns:**\nFileResponse with the report file\n\n**Example:**\n```\nGET /api/reports/download/report_20250117_143025.pdf\n```\n\n**Security Note:**\n- Only files from the configured reports output directory can be downloaded\n- Prevents directory traversal attacks","operationId":"download_report_api_reports_download__filename__get","parameters":[{"name":"filename","in":"path","required":true,"schema":{"type":"string","title":"Filename"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/reports/list":{"get":{"tags":["Reports"],"summary":"List Reports","description":"List all generated reports in the output directory\n\n**Returns:**\nList of report filenames with metadata\n\n**Example Response:**\n```json\n{\n    \"reports\": [\n        {\n            \"filename\": \"report_20250117_143025.pdf\",\n            \"size_bytes\": 125430,\n            \"created_at\": \"2025-01-17T14:30:25\",\n            \"format\": \"pdf\"\n        },\n        {\n            \"filename\": \"report_20250117_140512.xlsx\",\n            \"size_bytes\": 89234,\n            \"created_at\": \"2025-01-17T14:05:12\",\n            \"format\": \"excel\"\n        }\n    ],\n    \"total_reports\": 2\n}\n```","operationId":"list_reports_api_reports_list_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/actions/execute":{"post":{"tags":["Actions"],"summary":"Execute Action","description":"Execute an access control action\n\nThis endpoint processes action requests (grant, block, revoke access).\nIf the action requires confirmation, it returns awaiting_confirmation=True\nand the thread_id needed to confirm later.\n\n**Flow:**\n1. User sends action request\n2. If action requires confirmation:\n   - Returns confirmation_message and thread_id\n   - Frontend shows confirmation dialog\n   - User calls /actions/{thread_id}/approve or /reject\n3. If action doesn't need confirmation (e.g., list_access):\n   - Executes immediately and returns result\n\n**Example Request (Destructive Action):**\n```json\n{\n    \"question\": \"Grant user EMP001 access to Server Room\",\n    \"user_id\": \"admin_001\",\n    \"user_role\": \"ADMIN\",\n    \"session_id\": \"sess_123\"\n}\n```\n\n**Example Response (Awaiting Confirmation):**\n```json\n{\n    \"success\": true,\n    \"answer\": \"Grant access for user EMP001 to Server Room?...\",\n    \"action_type\": \"grant_access\",\n    \"awaiting_confirmation\": true,\n    \"confirmation_message\": \"Grant access for user EMP001...\",\n    \"thread_id\": \"sess_123\"\n}\n```","operationId":"execute_action_api_actions_execute_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/actions/pending":{"get":{"tags":["Actions"],"summary":"List Pending Actions","description":"List pending actions awaiting confirmation\n\n**Query Parameters:**\n- session_id: Filter by session (optional)\n- user_id: Filter by user (optional)\n\n**Example Response:**\n```json\n[\n    {\n        \"id\": \"uuid-123\",\n        \"session_id\": \"sess_123\",\n        \"user_id\": \"admin_001\",\n        \"user_role\": \"ADMIN\",\n        \"action_type\": \"grant_access\",\n        \"tool_name\": \"grant_access\",\n        \"action_params\": {\"target_user_id\": \"EMP001\", ...},\n        \"confirmation_message\": \"Grant access for user EMP001...\",\n        \"status\": \"pending\",\n        \"created_at\": \"2025-01-22T10:30:00Z\",\n        \"expires_at\": \"2025-01-22T10:35:00Z\",\n        \"langgraph_thread_id\": \"sess_123\"\n    }\n]\n```","operationId":"list_pending_actions_api_actions_pending_get","parameters":[{"name":"session_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"}},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PendingActionResponse"},"title":"Response List Pending Actions Api Actions Pending Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/actions/pending/{action_id}":{"get":{"tags":["Actions"],"summary":"Get Pending Action","description":"Get a specific pending action by ID\n\n**Path Parameters:**\n- action_id: UUID of the pending action","operationId":"get_pending_action_api_actions_pending__action_id__get","parameters":[{"name":"action_id","in":"path","required":true,"schema":{"type":"string","title":"Action Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PendingActionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/actions/{thread_id}/approve":{"post":{"tags":["Actions"],"summary":"Approve Action","description":"Approve a pending action and execute it\n\nThis resumes the LangGraph workflow with user confirmation,\nexecutes the action, and returns the result.\n\n**Path Parameters:**\n- thread_id: The LangGraph thread ID returned from /execute\n\n**Example Request:**\n```json\n{\n    \"user_id\": \"admin_001\"\n}\n```\n\n**Example Response:**\n```json\n{\n    \"success\": true,\n    \"action_id\": \"thread_123\",\n    \"status\": \"executed\",\n    \"message\": \"Access granted successfully.\",\n    \"result\": {\n        \"permission_id\": \"PERM-ABC123\",\n        \"target_name\": \"Server Room\"\n    }\n}\n```","operationId":"approve_action_api_actions__thread_id__approve_post","parameters":[{"name":"thread_id","in":"path","required":true,"schema":{"type":"string","title":"Thread Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmActionRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmActionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/actions/{thread_id}/reject":{"post":{"tags":["Actions"],"summary":"Reject Action","description":"Reject a pending action\n\nThis cancels the action and does not execute it.\n\n**Path Parameters:**\n- thread_id: The LangGraph thread ID returned from /execute\n\n**Example Request:**\n```json\n{\n    \"user_id\": \"admin_001\",\n    \"reason\": \"Request denied per company policy\"\n}\n```\n\n**Example Response:**\n```json\n{\n    \"success\": true,\n    \"action_id\": \"thread_123\",\n    \"status\": \"rejected\",\n    \"message\": \"Action cancelled by user\"\n}\n```","operationId":"reject_action_api_actions__thread_id__reject_post","parameters":[{"name":"thread_id","in":"path","required":true,"schema":{"type":"string","title":"Thread Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmActionRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmActionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/actions/pending/expired":{"delete":{"tags":["Actions"],"summary":"Cleanup Expired Actions","description":"Clean up expired pending actions\n\nMarks all expired pending actions as expired.\nThis can be called periodically or on-demand.\n\n**Example Response:**\n```json\n{\n    \"success\": true,\n    \"expired_count\": 5,\n    \"message\": \"Cleaned up 5 expired actions\"\n}\n```","operationId":"cleanup_expired_actions_api_actions_pending_expired_delete","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/onboarding/test-connection":{"post":{"tags":["Database Onboarding","Database Onboarding"],"summary":"Test Database Connection","description":"Test database connection before full onboarding\n\nThis endpoint verifies that the connection string is valid\nand the database is accessible.","operationId":"test_database_connection_api_onboarding_test_connection_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestConnectionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/onboarding/start":{"post":{"tags":["Database Onboarding","Database Onboarding"],"summary":"Start Onboarding","description":"Start automatic database onboarding\n\nThis initiates the fully automatic onboarding process:\n1. Extract database schema\n2. AI analyzes and understands the database\n3. Generate relevant Q&A examples\n4. Create embeddings for RAG\n\nThe process runs in the background. Use /status/{tenant_id} to check progress.","operationId":"start_onboarding_api_onboarding_start_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/onboarding/start-sync":{"post":{"tags":["Database Onboarding","Database Onboarding"],"summary":"Start Onboarding Sync","description":"Start automatic database onboarding (synchronous)\n\nThis runs the full onboarding process and waits for completion.\nUse this for smaller databases or when you need immediate results.\n\nFor larger databases, use /start which runs in the background.","operationId":"start_onboarding_sync_api_onboarding_start_sync_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DatabaseConnectionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/onboarding/status/{tenant_id}":{"get":{"tags":["Database Onboarding","Database Onboarding"],"summary":"Get Onboarding Status","description":"Get onboarding progress for a tenant\n\nReturns current status, progress percentage, and current step.","operationId":"get_onboarding_status_api_onboarding_status__tenant_id__get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/onboarding/tenant/{tenant_id}":{"get":{"tags":["Database Onboarding","Database Onboarding"],"summary":"Get Tenant Info","description":"Get tenant information and readiness status","operationId":"get_tenant_info_api_onboarding_tenant__tenant_id__get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Database Onboarding","Database Onboarding"],"summary":"Delete Tenant","description":"Delete all data for a tenant\n\nThis removes all embeddings and configurations for the tenant.","operationId":"delete_tenant_api_onboarding_tenant__tenant_id__delete","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/onboarding/onboard-current-db":{"post":{"tags":["Database Onboarding","Database Onboarding"],"summary":"Onboard Current Database","description":"Onboard the currently configured database (from .env settings)\n\nThis is a convenience endpoint to onboard the database specified\nin the application's environment variables.","operationId":"onboard_current_database_api_onboarding_onboard_current_db_post","parameters":[{"name":"tenant_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"default","title":"Tenant Id"}},{"name":"tenant_name","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"default":"OryggiDB","title":"Tenant Name"}},{"name":"fewshot_count","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Fewshot Count"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/usage/today":{"get":{"tags":["Usage Statistics"],"summary":"Get today's usage","description":"Get usage statistics for today","operationId":"get_today_usage_api_usage_today_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"JWT":[]}]}},"/api/usage/summary":{"get":{"tags":["Usage Statistics"],"summary":"Get usage summary","description":"Get aggregated usage statistics for a time period","operationId":"get_usage_summary_api_usage_summary_get","security":[{"JWT":[]}],"parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"description":"Number of days to include","default":30,"title":"Days"},"description":"Number of days to include"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/usage/daily":{"get":{"tags":["Usage Statistics"],"summary":"Get daily usage breakdown","description":"Get day-by-day usage metrics","operationId":"get_daily_usage_api_usage_daily_get","security":[{"JWT":[]}],"parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":90,"minimum":1,"description":"Number of days to include","default":7,"title":"Days"},"description":"Number of days to include"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/usage/limits":{"get":{"tags":["Usage Statistics"],"summary":"Check usage limits","description":"Check current usage against plan limits","operationId":"check_usage_limits_api_usage_limits_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"JWT":[]}]}},"/api/usage/audit":{"get":{"tags":["Usage Statistics"],"summary":"Get audit logs","description":"Get audit trail for the tenant (admin only)","operationId":"get_audit_logs_api_usage_audit_get","security":[{"JWT":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"description":"Maximum records to return","default":50,"title":"Limit"},"description":"Maximum records to return"},{"name":"event_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by event type","title":"Event Type"},"description":"Filter by event type"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"Filter by start date","title":"Start Date"},"description":"Filter by start date"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"Filter by end date","title":"End Date"},"description":"Filter by end date"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/usage/audit/events":{"get":{"tags":["Usage Statistics"],"summary":"Get available event types","description":"Get list of available event types for filtering","operationId":"get_event_types_api_usage_audit_events_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"JWT":[]}]}},"/api/usage/dashboard":{"get":{"tags":["Usage Statistics"],"summary":"Get dashboard summary","description":"Get comprehensive dashboard data in a single call","operationId":"get_dashboard_summary_api_usage_dashboard_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"JWT":[]}]}},"/api/gateway/status":{"get":{"tags":["Gateway","Gateway"],"summary":"Get Gateway Status","description":"Get status of all gateway connections for the current tenant\n\nReturns:\n    List of active gateway sessions","operationId":"get_gateway_status_api_gateway_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"JWT":[]}]}},"/api/gateway/status/{database_id}":{"get":{"tags":["Gateway","Gateway"],"summary":"Get Database Gateway Status","description":"Get gateway status for a specific database\n\nArgs:\n    database_id: Database UUID\n\nReturns:\n    Gateway connection status and session info","operationId":"get_database_gateway_status_api_gateway_status__database_id__get","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/databases/{database_id}/token-status":{"get":{"tags":["Gateway","Gateway"],"summary":"Get Gateway Token Status","description":"Check if an active gateway token exists for this database.\nReturns token metadata (not the token itself) for UI display.","operationId":"get_gateway_token_status_api_gateway_databases__database_id__token_status_get","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/databases/{database_id}/generate-token":{"post":{"tags":["Gateway","Gateway"],"summary":"Generate Gateway Token","description":"Generate a gateway token for a database.\n\nThis token is used by the gateway agent to authenticate.\nTokens DO NOT expire automatically (enterprise-grade).\n\nIMPORTANT: If an active token exists and force=False, returns warning.\nUse force=True to revoke old token and generate new one.\n\nArgs:\n    database_id: Database UUID\n    token_name: Optional name for the token\n    force: If True, revoke existing token and generate new one\n\nReturns:\n    Generated token (shown only once) or warning if active token exists","operationId":"generate_gateway_token_api_gateway_databases__database_id__generate_token_post","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}},{"name":"token_name","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Name for the token","title":"Token Name"},"description":"Name for the token"},{"name":"force","in":"query","required":false,"schema":{"type":"boolean","description":"Force regenerate even if active token exists","default":false,"title":"Force"},"description":"Force regenerate even if active token exists"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/databases/{database_id}/revoke-token":{"delete":{"tags":["Gateway","Gateway"],"summary":"Revoke Gateway Token","description":"Revoke the gateway token for a database\n\nArgs:\n    database_id: Database UUID\n\nReturns:\n    Success status","operationId":"revoke_gateway_token_api_gateway_databases__database_id__revoke_token_delete","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/databases/{database_id}/set-connection-mode":{"post":{"tags":["Gateway","Gateway"],"summary":"Set Connection Mode","description":"Set the connection mode for a database\n\nModes:\n- auto: Try direct first, fallback to gateway\n- gateway_only: Only use gateway (requires gateway token)\n- direct_only: Only use direct connection\n\nArgs:\n    database_id: Database UUID\n    mode: Connection mode\n\nReturns:\n    Updated database configuration","operationId":"set_connection_mode_api_gateway_databases__database_id__set_connection_mode_post","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}},{"name":"mode","in":"query","required":true,"schema":{"type":"string","description":"Connection mode: auto, gateway_only, direct_only","title":"Mode"},"description":"Connection mode: auto, gateway_only, direct_only"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/download-agent":{"get":{"tags":["Gateway","Gateway"],"summary":"Download Gateway Agent","description":"Download the Gateway Agent package\n\nReturns a ZIP file containing the gateway agent for installation\non client premises.","operationId":"download_gateway_agent_api_gateway_download_agent_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/gateway/download-installer":{"get":{"tags":["Gateway","Gateway"],"summary":"Download Installer Script","description":"Download a pre-configured installer script with gateway token embedded.\n\nThis endpoint generates a customized setup script that users can run\nto automatically install and configure the gateway agent.\n\nArgs:\n    gateway_token: The gateway token (from generate-token endpoint)\n    db_database: SQL Server database name\n    db_host: SQL Server host (default: host.docker.internal for Docker)\n    db_port: SQL Server port (default: 1433)\n    db_username: SQL Server username (default: sa)\n    format: Script format - powershell, batch, or compose\n\nReturns:\n    A downloadable script file with pre-filled configuration","operationId":"download_installer_script_api_gateway_download_installer_get","parameters":[{"name":"gateway_token","in":"query","required":true,"schema":{"type":"string","description":"Gateway token to embed in script","title":"Gateway Token"},"description":"Gateway token to embed in script"},{"name":"db_database","in":"query","required":false,"schema":{"type":"string","description":"Database name","default":"YourDatabaseName","title":"Db Database"},"description":"Database name"},{"name":"db_host","in":"query","required":false,"schema":{"type":"string","description":"SQL Server host","default":"host.docker.internal","title":"Db Host"},"description":"SQL Server host"},{"name":"db_port","in":"query","required":false,"schema":{"type":"string","description":"SQL Server port","default":"1433","title":"Db Port"},"description":"SQL Server port"},{"name":"db_username","in":"query","required":false,"schema":{"type":"string","description":"SQL Server username","default":"sa","title":"Db Username"},"description":"SQL Server username"},{"name":"format","in":"query","required":false,"schema":{"type":"string","description":"Script format: powershell, batch, or compose","default":"powershell","title":"Format"},"description":"Script format: powershell, batch, or compose"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/download-native-installer":{"get":{"tags":["Gateway","Gateway"],"summary":"Download Native Installer","description":"Download the native Windows installer for zero-config gateway setup.\n\nThis installer:\n- Requires NO Docker\n- Uses Windows Authentication (no SQL password needed!)\n- Auto-discovers databases\n- Runs as Windows Service for auto-start\n\nArgs:\n    gateway_token: The gateway token from generate-token endpoint\n    db_database: Optional database name to pre-select\n\nReturns:\n    Redirect to download the native installer with embedded token","operationId":"download_native_installer_api_gateway_download_native_installer_get","parameters":[{"name":"gateway_token","in":"query","required":true,"schema":{"type":"string","description":"Gateway token to embed","title":"Gateway Token"},"description":"Gateway token to embed"},{"name":"db_database","in":"query","required":false,"schema":{"type":"string","description":"Database name (optional, can be selected in app)","default":"","title":"Db Database"},"description":"Database name (optional, can be selected in app)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/download-agent-exe":{"get":{"tags":["Gateway","Gateway"],"summary":"Download Agent Exe","description":"Download the Gateway Agent executable (Windows Service version).\n\nThis endpoint serves the pre-built OryggiGatewayService.exe for the\nPowerShell installer script to download automatically.\n\nReturns:\n    The gateway agent service executable file","operationId":"download_agent_exe_api_gateway_download_agent_exe_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/gateway/download-zero-config-installer":{"get":{"tags":["Gateway","Gateway"],"summary":"Download Zero Config Installer","description":"Download the Zero-Config Gateway Agent Installer.\n\nThis endpoint returns a ZIP file containing:\n1. OryggiAI-Gateway-Launcher.exe - Small launcher that auto-runs installer\n2. gateway-launch-config.json - Pre-filled configuration with your token\n\nCustomer just extracts and double-clicks - NO PowerShell, NO commands!\n\nThe launcher will:\n- Download the full installer automatically\n- Run it with pre-filled token and database\n- Handle admin privileges automatically\n- Provide GUI progress feedback\n\nArgs:\n    gateway_token: The gateway token from generate-token endpoint\n    db_database: Optional database name to pre-select\n\nReturns:\n    ZIP file for download","operationId":"download_zero_config_installer_api_gateway_download_zero_config_installer_get","parameters":[{"name":"gateway_token","in":"query","required":true,"schema":{"type":"string","description":"Gateway token to embed","title":"Gateway Token"},"description":"Gateway token to embed"},{"name":"db_database","in":"query","required":false,"schema":{"type":"string","description":"Database name (optional)","default":"","title":"Db Database"},"description":"Database name (optional)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/gateway/download-installer-exe":{"get":{"tags":["Gateway","Gateway"],"summary":"Download Installer Exe","description":"Download the Inno Setup installer executable.\n\nThis is the main installer that the launcher downloads.\nReturns the OryggiAI-Gateway-Setup.exe file.","operationId":"download_installer_exe_api_gateway_download_installer_exe_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/query-logs/history":{"get":{"tags":["Query Logs","Query Logs"],"summary":"Get Query History","description":"Get query history for the current tenant.\n\nReturns a paginated list of all queries executed through the platform,\nincluding the original questions asked and the SQL queries generated.\n\nQuery Parameters:\n- limit: Max records to return (default 50, max 500)\n- offset: Pagination offset\n- database_id: Filter by specific database\n- status: Filter by status (success/error/timeout)\n- start_date: Filter by start date (ISO format)\n- end_date: Filter by end date (ISO format)","operationId":"get_query_history_api_query_logs_history_get","security":[{"JWT":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"description":"Number of records to return","default":50,"title":"Limit"},"description":"Number of records to return"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset","default":0,"title":"Offset"},"description":"Pagination offset"},{"name":"database_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by database ID","title":"Database Id"},"description":"Filter by database ID"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by status: success, error, timeout","title":"Status"},"description":"Filter by status: success, error, timeout"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by start date (ISO format)","title":"Start Date"},"description":"Filter by start date (ISO format)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by end date (ISO format)","title":"End Date"},"description":"Filter by end date (ISO format)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/query-logs/analytics":{"get":{"tags":["Query Logs","Query Logs"],"summary":"Get Query Analytics","description":"Get query analytics for the current tenant.\n\nReturns aggregated statistics about query usage including:\n- Total queries\n- Success/error counts\n- Average execution time\n- Token usage\n\nQuery Parameters:\n- start_date: Filter by start date (ISO format)\n- end_date: Filter by end date (ISO format)","operationId":"get_query_analytics_api_query_logs_analytics_get","security":[{"JWT":[]}],"parameters":[{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by start date (ISO format)","title":"Start Date"},"description":"Filter by start date (ISO format)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by end date (ISO format)","title":"End Date"},"description":"Filter by end date (ISO format)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/query-logs/databases/{database_id}/history":{"get":{"tags":["Query Logs","Query Logs"],"summary":"Get Database Query History","description":"Get query history for a specific database.\n\nConvenience endpoint for filtering by database.","operationId":"get_database_query_history_api_query_logs_databases__database_id__history_get","security":[{"JWT":[]}],"parameters":[{"name":"database_id","in":"path","required":true,"schema":{"type":"string","title":"Database Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"description":"Number of records to return","default":50,"title":"Limit"},"description":"Number of records to return"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset","default":0,"title":"Offset"},"description":"Pagination offset"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/query-logs/recent":{"get":{"tags":["Query Logs","Query Logs"],"summary":"Get Recent Queries","description":"Get the most recent queries for the current tenant.\n\nQuick endpoint for dashboard display showing latest activity.","operationId":"get_recent_queries_api_query_logs_recent_get","security":[{"JWT":[]}],"parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":50,"minimum":1,"description":"Number of recent queries to return","default":10,"title":"Limit"},"description":"Number of recent queries to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/health":{"get":{"tags":["Admin Dashboard"],"summary":"Admin Health Check","description":"Health check endpoint for admin API.","operationId":"admin_health_check_api_admin_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/admin/tenants":{"get":{"tags":["Admin Dashboard"],"summary":"Get All Tenants","description":"Get all chatbot tenants with their online/offline status.\n\nReturns:\n- Tenant list with connection status\n- Query statistics per tenant\n- Last activity information\n\nHeaders Required:\n- X-Admin-API-Key: Admin authentication key","operationId":"get_all_tenants_api_admin_tenants_get","parameters":[{"name":"include_inactive","in":"query","required":false,"schema":{"type":"boolean","description":"Include inactive/suspended tenants","default":false,"title":"Include Inactive"},"description":"Include inactive/suspended tenants"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"description":"Number of records to return","default":50,"title":"Limit"},"description":"Number of records to return"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset","default":0,"title":"Offset"},"description":"Pagination offset"},{"name":"X-Admin-API-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/tenants/{tenant_id}":{"get":{"tags":["Admin Dashboard"],"summary":"Get Tenant Detail","description":"Get detailed information about a specific tenant.\n\nReturns:\n- Tenant information\n- Database connections\n- Active gateway sessions\n- Session history\n- Query statistics\n- Recent queries with Q&A\n\nHeaders Required:\n- X-Admin-API-Key: Admin authentication key","operationId":"get_tenant_detail_api_admin_tenants__tenant_id__get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-API-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/tenants/{tenant_id}/queries":{"get":{"tags":["Admin Dashboard"],"summary":"Get Tenant Queries","description":"Get detailed query history for a specific tenant.\n\nReturns paginated list of all queries with:\n- Natural language question asked\n- SQL query generated\n- Execution results\n- Token usage\n- Response times\n\nHeaders Required:\n- X-Admin-API-Key: Admin authentication key","operationId":"get_tenant_queries_api_admin_tenants__tenant_id__queries_get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"description":"Number of records to return","default":50,"title":"Limit"},"description":"Number of records to return"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset","default":0,"title":"Offset"},"description":"Pagination offset"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by status (success/error)","title":"Status"},"description":"Filter by status (success/error)"},{"name":"search","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search in questions","title":"Search"},"description":"Search in questions"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by start date (ISO format)","title":"Start Date"},"description":"Filter by start date (ISO format)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by end date (ISO format)","title":"End Date"},"description":"Filter by end date (ISO format)"},{"name":"X-Admin-API-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/analytics":{"get":{"tags":["Admin Dashboard"],"summary":"Get Platform Analytics","description":"Get overall platform analytics.\n\nReturns:\n- Tenant statistics (total, active, online)\n- Query statistics (total, success rate, avg time)\n- Top tenants by query volume\n- Token usage summary\n\nHeaders Required:\n- X-Admin-API-Key: Admin authentication key","operationId":"get_platform_analytics_api_admin_analytics_get","parameters":[{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Analytics start date (ISO format)","title":"Start Date"},"description":"Analytics start date (ISO format)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Analytics end date (ISO format)","title":"End Date"},"description":"Analytics end date (ISO format)"},{"name":"X-Admin-API-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/admin/dashboard":{"get":{"tags":["Admin Dashboard"],"summary":"Get Admin Dashboard","description":"Get combined dashboard data for quick overview.\n\nReturns all data needed for the admin dashboard in a single call:\n- Platform analytics summary\n- Online/offline tenant counts\n- Top 5 most active tenants\n- Recent queries across all tenants\n\nHeaders Required:\n- X-Admin-API-Key: Admin authentication key","operationId":"get_admin_dashboard_api_admin_dashboard_get","parameters":[{"name":"X-Admin-API-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ActionRequest":{"properties":{"question":{"type":"string","title":"Question","description":"User's action request in natural language"},"user_id":{"type":"string","title":"User Id","description":"User ID"},"user_role":{"type":"string","title":"User Role","description":"User's role (ADMIN, HR_MANAGER, etc.)"},"session_id":{"type":"string","title":"Session Id","description":"Chat session ID"}},"additionalProperties":false,"type":"object","required":["question","user_id","user_role","session_id"],"title":"ActionRequest","description":"Request to execute an access control action"},"ActionResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"answer":{"type":"string","title":"Answer"},"action_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Action Type"},"awaiting_confirmation":{"type":"boolean","title":"Awaiting Confirmation","default":false},"confirmation_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Confirmation Message"},"thread_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Thread Id"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"tools_called":{"items":{"type":"string"},"type":"array","title":"Tools Called","default":[]}},"type":"object","required":["success","answer"],"title":"ActionResponse","description":"Response from action execution"},"ChatQueryRequest":{"properties":{"question":{"type":"string","minLength":1,"title":"Question","description":"User's natural language question"},"tenant_id":{"type":"string","title":"Tenant Id","description":"Tenant identifier","default":"default"},"user_id":{"type":"string","title":"User Id","description":"User identifier","default":"system"},"user_role":{"type":"string","title":"User Role","description":"User role for RBAC (ADMIN, HR_MANAGER, HR_STAFF, VIEWER)","default":"VIEWER"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id","description":"Session ID for conversation continuity (auto-generated if not provided)"}},"type":"object","required":["question"],"title":"ChatQueryRequest","description":"Request model for chat query endpoint"},"ChatQueryResponse":{"properties":{"session_id":{"type":"string","title":"Session Id","description":"Session ID for conversation continuity"},"question":{"type":"string","title":"Question","description":"Original question"},"sql_query":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sql Query","description":"Generated SQL query"},"answer":{"type":"string","title":"Answer","description":"Natural language answer"},"result_count":{"type":"integer","title":"Result Count","description":"Number of results returned","default":0},"tables_used":{"items":{"type":"string"},"type":"array","title":"Tables Used","description":"Database tables referenced"},"execution_time":{"type":"number","title":"Execution Time","description":"Query execution time in seconds"},"success":{"type":"boolean","title":"Success","description":"Whether query succeeded"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if failed"},"results":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Results","description":"Structured query results for table display"},"needs_clarification":{"type":"boolean","title":"Needs Clarification","description":"Whether the query needs clarification","default":false},"clarification_question":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Clarification Question","description":"Clarifying question to ask user"},"clarification_options":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Clarification Options","description":"Selectable options for clarification"},"clarification_attempt":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Clarification Attempt","description":"Current clarification attempt (1-3)"},"max_clarification_attempts":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Clarification Attempts","description":"Maximum clarification attempts","default":3},"original_unclear_question":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Original Unclear Question","description":"Original question that was unclear"}},"type":"object","required":["session_id","question","answer","execution_time","success"],"title":"ChatQueryResponse","description":"Response model for chat query endpoint\n\nIncludes clarification fields for handling unclear/ambiguous prompts.\nWhen needs_clarification=True, the frontend should display the\nclarification_question and options instead of processing the query."},"ConfirmActionRequest":{"properties":{"user_id":{"type":"string","title":"User Id","description":"User confirming/rejecting"},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason","description":"Reason for rejection (if rejected)"}},"additionalProperties":false,"type":"object","required":["user_id"],"title":"ConfirmActionRequest","description":"Request to confirm or reject an action"},"ConfirmActionResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"action_id":{"type":"string","title":"Action Id"},"status":{"type":"string","title":"Status"},"message":{"type":"string","title":"Message"},"result":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Result"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success","action_id","status","message"],"title":"ConfirmActionResponse","description":"Response after confirming/rejecting an action"},"DatabaseConnectionCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":2,"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Description"},"db_type":{"$ref":"#/components/schemas/DatabaseType"},"host":{"type":"string","maxLength":255,"minLength":1,"title":"Host"},"port":{"type":"integer","exclusiveMaximum":65536.0,"exclusiveMinimum":0.0,"title":"Port"},"database_name":{"type":"string","maxLength":255,"minLength":1,"title":"Database Name"},"username":{"type":"string","maxLength":255,"minLength":1,"title":"Username"},"password":{"type":"string","maxLength":500,"minLength":1,"title":"Password"},"use_ssl":{"type":"boolean","title":"Use Ssl","default":false},"connection_timeout":{"type":"integer","maximum":300.0,"minimum":5.0,"title":"Connection Timeout","default":30},"query_timeout":{"type":"integer","maximum":600.0,"minimum":5.0,"title":"Query Timeout","default":60}},"type":"object","required":["name","db_type","host","port","database_name","username","password"],"title":"DatabaseConnectionCreate","description":"Schema for creating a new database connection"},"DatabaseConnectionRequest":{"properties":{"connection_string":{"type":"string","title":"Connection String","description":"SQLAlchemy connection string","example":"mssql+pyodbc://user:pass@server/db?driver=ODBC+Driver+17+for+SQL+Server"},"tenant_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tenant Id","description":"Optional tenant ID (auto-generated if not provided)"},"tenant_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tenant Name","description":"Optional tenant/organization name"},"db_schema":{"type":"string","title":"Db Schema","description":"Database schema name","default":"dbo"},"fewshot_count":{"type":"integer","maximum":200.0,"minimum":10.0,"title":"Fewshot Count","description":"Number of few-shot examples to generate","default":50},"include_views":{"type":"boolean","title":"Include Views","description":"Include database views in analysis","default":true}},"type":"object","required":["connection_string"],"title":"DatabaseConnectionRequest","description":"Request model for database connection"},"DatabaseConnectionResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"db_type":{"type":"string","title":"Db Type"},"host":{"type":"string","title":"Host"},"port":{"type":"integer","title":"Port"},"database_name":{"type":"string","title":"Database Name"},"username":{"type":"string","title":"Username"},"use_ssl":{"type":"boolean","title":"Use Ssl"},"connection_timeout":{"type":"integer","title":"Connection Timeout"},"query_timeout":{"type":"integer","title":"Query Timeout"},"is_active":{"type":"boolean","title":"Is Active"},"schema_analyzed":{"type":"boolean","title":"Schema Analyzed"},"analysis_status":{"type":"string","title":"Analysis Status"},"analysis_error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Analysis Error"},"last_analysis_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Analysis At"},"detected_organization_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Detected Organization Type"},"table_count":{"type":"integer","title":"Table Count"},"view_count":{"type":"integer","title":"View Count"},"auto_sync_enabled":{"type":"boolean","title":"Auto Sync Enabled"},"sync_interval_hours":{"type":"integer","title":"Sync Interval Hours"},"last_sync_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Sync At"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","tenant_id","name","description","db_type","host","port","database_name","username","use_ssl","connection_timeout","query_timeout","is_active","schema_analyzed","analysis_status","analysis_error","last_analysis_at","detected_organization_type","table_count","view_count","auto_sync_enabled","sync_interval_hours","last_sync_at","created_at","updated_at"],"title":"DatabaseConnectionResponse","description":"Response schema for database connection"},"DatabaseConnectionSummary":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"name":{"type":"string","title":"Name"},"db_type":{"type":"string","title":"Db Type"},"host":{"type":"string","title":"Host"},"port":{"type":"integer","title":"Port"},"database_name":{"type":"string","title":"Database Name"},"is_active":{"type":"boolean","title":"Is Active"},"schema_analyzed":{"type":"boolean","title":"Schema Analyzed"},"analysis_status":{"type":"string","title":"Analysis Status"},"table_count":{"type":"integer","title":"Table Count"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At"}},"type":"object","required":["id","name","db_type","host","port","database_name","is_active","schema_analyzed","analysis_status","table_count"],"title":"DatabaseConnectionSummary","description":"Brief database connection summary"},"DatabaseConnectionUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":2},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Description"},"host":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Host"},"port":{"anyOf":[{"type":"integer","exclusiveMaximum":65536.0,"exclusiveMinimum":0.0},{"type":"null"}],"title":"Port"},"database_name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Database Name"},"username":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Username"},"password":{"anyOf":[{"type":"string","maxLength":500,"minLength":1},{"type":"null"}],"title":"Password"},"use_ssl":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Use Ssl"},"connection_timeout":{"anyOf":[{"type":"integer","maximum":300.0,"minimum":5.0},{"type":"null"}],"title":"Connection Timeout"},"query_timeout":{"anyOf":[{"type":"integer","maximum":600.0,"minimum":5.0},{"type":"null"}],"title":"Query Timeout"}},"type":"object","title":"DatabaseConnectionUpdate","description":"Schema for updating database connection"},"DatabaseTestResult":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"},"connection_time_ms":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Connection Time Ms"},"server_version":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Server Version"}},"type":"object","required":["success","message"],"title":"DatabaseTestResult","description":"Result of database connection test"},"DatabaseType":{"type":"string","enum":["mssql","postgresql","mysql","sqlite","oracle"],"title":"DatabaseType","description":"Supported database types"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LoginRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User's email address"},"password":{"type":"string","title":"Password","description":"User's password"}},"type":"object","required":["email","password"],"title":"LoginRequest","description":"Request schema for user login","example":{"email":"admin@acme.com","password":"SecurePass123!"}},"LoginResponse":{"properties":{"message":{"type":"string","title":"Message"},"user":{"$ref":"#/components/schemas/UserResponse"},"tokens":{"$ref":"#/components/schemas/TokenResponse"}},"type":"object","required":["message","user","tokens"],"title":"LoginResponse","description":"Response schema for successful login","example":{"message":"Login successful","tokens":{"access_token":"eyJhbGciOiJIUzI1NiIs...","expires_in":1800,"refresh_token":"eyJhbGciOiJIUzI1NiIs...","token_type":"bearer"},"user":{"email":"admin@acme.com","full_name":"John Smith","id":"550e8400-e29b-41d4-a716-446655440000","role":"owner","tenant_id":"123e4567-e89b-12d3-a456-426614174000"}}},"MTChatRequest":{"properties":{"question":{"type":"string","title":"Question","description":"User's natural language question"},"database_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Database Id","description":"Specific database ID (uses default if not provided)"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id","description":"Session ID for conversation continuity"}},"type":"object","required":["question"],"title":"MTChatRequest","description":"Multi-tenant chat request"},"OnboardingResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"tenant_id":{"type":"string","title":"Tenant Id"},"message":{"type":"string","title":"Message"},"details":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Details"}},"type":"object","required":["success","tenant_id","message"],"title":"OnboardingResponse","description":"Response model for onboarding operations"},"OnboardingStatusResponse":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id"},"status":{"type":"string","title":"Status"},"progress":{"type":"integer","title":"Progress"},"current_step":{"type":"string","title":"Current Step"},"details":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Details"}},"type":"object","required":["tenant_id","status","progress","current_step"],"title":"OnboardingStatusResponse","description":"Response model for onboarding status"},"PasswordChangeRequest":{"properties":{"current_password":{"type":"string","title":"Current Password","description":"Current password"},"new_password":{"type":"string","maxLength":128,"minLength":8,"title":"New Password","description":"New password"}},"type":"object","required":["current_password","new_password"],"title":"PasswordChangeRequest","description":"Request schema for changing password (when logged in)","example":{"current_password":"OldSecurePass123!","new_password":"NewSecurePass456!"}},"PasswordResetConfirm":{"properties":{"token":{"type":"string","title":"Token","description":"Password reset token from email"},"new_password":{"type":"string","maxLength":128,"minLength":8,"title":"New Password","description":"New password"}},"type":"object","required":["token","new_password"],"title":"PasswordResetConfirm","description":"Request schema for confirming password reset","example":{"new_password":"NewSecurePass789!","token":"eyJhbGciOiJIUzI1NiIs..."}},"PasswordResetRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"Email address for password reset"}},"type":"object","required":["email"],"title":"PasswordResetRequest","description":"Request schema for initiating password reset","example":{"email":"user@acme.com"}},"PendingActionResponse":{"properties":{"id":{"type":"string","title":"Id"},"session_id":{"type":"string","title":"Session Id"},"user_id":{"type":"string","title":"User Id"},"user_role":{"type":"string","title":"User Role"},"action_type":{"type":"string","title":"Action Type"},"tool_name":{"type":"string","title":"Tool Name"},"action_params":{"type":"object","title":"Action Params"},"confirmation_message":{"type":"string","title":"Confirmation Message"},"status":{"type":"string","title":"Status"},"created_at":{"type":"string","title":"Created At"},"expires_at":{"type":"string","title":"Expires At"},"langgraph_thread_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Langgraph Thread Id"}},"type":"object","required":["id","session_id","user_id","user_role","action_type","tool_name","action_params","confirmation_message","status","created_at","expires_at"],"title":"PendingActionResponse","description":"Representation of a pending action"},"RefreshTokenRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token","description":"JWT refresh token"}},"type":"object","required":["refresh_token"],"title":"RefreshTokenRequest","description":"Request schema for refreshing access token","example":{"refresh_token":"eyJhbGciOiJIUzI1NiIs..."}},"RegistrationResponse":{"properties":{"message":{"type":"string","title":"Message"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"user_id":{"type":"string","format":"uuid","title":"User Id"},"email":{"type":"string","title":"Email"},"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"}},"type":"object","required":["message","tenant_id","user_id","email","access_token","refresh_token"],"title":"RegistrationResponse","description":"Response schema for successful registration","example":{"access_token":"eyJhbGciOiJIUzI1NiIs...","email":"admin@acme.com","message":"Registration successful","refresh_token":"eyJhbGciOiJIUzI1NiIs...","tenant_id":"123e4567-e89b-12d3-a456-426614174000","token_type":"bearer","user_id":"550e8400-e29b-41d4-a716-446655440000"}},"ReportGenerateRequest":{"properties":{"question":{"type":"string","minLength":1,"title":"Question","description":"User's natural language question"},"format":{"type":"string","title":"Format","description":"Report format: 'pdf' or 'excel'","default":"pdf"},"tenant_id":{"type":"string","title":"Tenant Id","description":"Tenant identifier","default":"default"},"user_id":{"type":"string","title":"User Id","description":"User identifier","default":"system"},"user_role":{"type":"string","title":"User Role","description":"User role for RBAC (ADMIN, HR_MANAGER, HR_STAFF, VIEWER)","default":"VIEWER"},"filename":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Filename","description":"Custom filename for the report (optional)"},"max_rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Rows","description":"Maximum rows to include in report (optional)"},"department":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Department","description":"Department filter for HR_MANAGER role (optional)"},"email_to":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email To","description":"Email address to send report (Phase 4 - Email Integration)"}},"type":"object","required":["question"],"title":"ReportGenerateRequest","description":"Request model for report generation endpoint"},"ReportGenerateResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether report generation succeeded"},"report_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Report Path","description":"Path to generated report file"},"format":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Format","description":"Report format (pdf or excel)"},"rows_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rows Count","description":"Number of rows in report"},"execution_time_ms":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Execution Time Ms","description":"Execution time in milliseconds"},"question":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Question","description":"Original question"},"sql_query":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sql Query","description":"SQL query executed"},"truncated":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Truncated","description":"Whether report was truncated"},"max_rows":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Rows","description":"Maximum rows limit applied"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if failed"},"email_sent":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Email Sent","description":"Whether report was emailed successfully"},"email_to":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email To","description":"Email address where report was sent"},"email_error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email Error","description":"Email sending error (if any)"}},"type":"object","required":["success"],"title":"ReportGenerateResponse","description":"Response model for report generation endpoint"},"SchemaIndexRequest":{"properties":{"force_reindex":{"type":"boolean","title":"Force Reindex","description":"Force full re-indexing","default":false}},"type":"object","title":"SchemaIndexRequest","description":"Request model for schema indexing endpoint"},"SchemaIndexResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether indexing succeeded"},"embeddings_count":{"type":"integer","title":"Embeddings Count","description":"Number of embeddings created"},"tables_count":{"type":"integer","title":"Tables Count","description":"Number of tables indexed"},"message":{"type":"string","title":"Message","description":"Status message"}},"type":"object","required":["success","embeddings_count","tables_count","message"],"title":"SchemaIndexResponse","description":"Response model for schema indexing"},"TenantRegistrationRequest":{"properties":{"tenant_name":{"type":"string","maxLength":255,"minLength":2,"title":"Tenant Name","description":"Company or organization name"},"tenant_slug":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Tenant Slug","description":"URL-friendly identifier (auto-generated if not provided)"},"email":{"type":"string","format":"email","title":"Email","description":"Owner's email address"},"password":{"type":"string","maxLength":128,"minLength":8,"title":"Password","description":"Password (min 8 characters)"},"full_name":{"type":"string","maxLength":255,"minLength":2,"title":"Full Name","description":"Owner's full name"}},"type":"object","required":["tenant_name","email","password","full_name"],"title":"TenantRegistrationRequest","description":"Request schema for registering a new tenant (company/organization)","example":{"email":"admin@acme.com","full_name":"John Smith","password":"SecurePass123!","tenant_name":"Acme Corporation","tenant_slug":"acme-corp"}},"TenantResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"name":{"type":"string","title":"Name"},"slug":{"type":"string","title":"Slug"},"organization_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Organization Type"},"industry":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Industry"},"company_size":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Company Size"},"admin_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Admin Email"},"phone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Phone"},"address":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Address"},"country":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Country"},"timezone":{"type":"string","title":"Timezone"},"status":{"type":"string","title":"Status"},"plan":{"type":"string","title":"Plan"},"trial_ends_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Trial Ends At"},"max_users":{"type":"integer","title":"Max Users"},"max_databases":{"type":"integer","title":"Max Databases"},"max_queries_per_day":{"type":"integer","title":"Max Queries Per Day"},"max_storage_mb":{"type":"integer","title":"Max Storage Mb"},"logo_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Logo Url"},"primary_color":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Primary Color"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","name","slug","organization_type","industry","company_size","admin_email","phone","address","country","timezone","status","plan","trial_ends_at","max_users","max_databases","max_queries_per_day","max_storage_mb","logo_url","primary_color","created_at","updated_at"],"title":"TenantResponse","description":"Response schema for tenant details"},"TenantUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":2},{"type":"null"}],"title":"Name"},"organization_type":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Organization Type"},"industry":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Industry"},"company_size":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Company Size"},"phone":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Phone"},"address":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Address"},"country":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Country"},"timezone":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Timezone"},"logo_url":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Logo Url"},"primary_color":{"anyOf":[{"type":"string","maxLength":20},{"type":"null"}],"title":"Primary Color"}},"type":"object","title":"TenantUpdate","description":"Schema for updating tenant information"},"TenantUsageStats":{"properties":{"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"user_count":{"type":"integer","title":"User Count"},"active_user_count":{"type":"integer","title":"Active User Count"},"database_count":{"type":"integer","title":"Database Count"},"active_database_count":{"type":"integer","title":"Active Database Count"},"total_tables":{"type":"integer","title":"Total Tables"},"total_views":{"type":"integer","title":"Total Views"},"queries_today":{"type":"integer","title":"Queries Today"},"queries_this_month":{"type":"integer","title":"Queries This Month"},"storage_used_mb":{"type":"number","title":"Storage Used Mb"}},"type":"object","required":["tenant_id","user_count","active_user_count","database_count","active_database_count","total_tables","total_views","queries_today","queries_this_month","storage_used_mb"],"title":"TenantUsageStats","description":"Tenant usage statistics"},"TenantUserCreate":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","maxLength":128,"minLength":8,"title":"Password"},"full_name":{"type":"string","maxLength":255,"minLength":2,"title":"Full Name"},"role":{"type":"string","title":"Role","default":"user"}},"type":"object","required":["email","password","full_name"],"title":"TenantUserCreate","description":"Schema for creating a user within tenant"},"TenantUserResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"email":{"type":"string","title":"Email"},"first_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"First Name"},"last_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Name"},"display_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Name"},"phone":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Phone"},"role":{"type":"string","title":"Role"},"is_active":{"type":"boolean","title":"Is Active"},"is_verified":{"type":"boolean","title":"Is Verified"},"last_login_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login At"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","tenant_id","email","first_name","last_name","display_name","phone","role","is_active","is_verified","last_login_at","created_at","updated_at"],"title":"TenantUserResponse","description":"Response schema for tenant user"},"TenantUserSummary":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"email":{"type":"string","title":"Email"},"display_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Name"},"role":{"type":"string","title":"Role"},"is_active":{"type":"boolean","title":"Is Active"}},"type":"object","required":["id","email","display_name","role","is_active"],"title":"TenantUserSummary","description":"Brief user summary"},"TenantUserUpdate":{"properties":{"first_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"First Name"},"last_name":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Last Name"},"display_name":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Display Name"},"phone":{"anyOf":[{"type":"string","maxLength":50},{"type":"null"}],"title":"Phone"},"role":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Role"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","title":"TenantUserUpdate","description":"Schema for updating a user within tenant"},"TestConnectionRequest":{"properties":{"connection_string":{"type":"string","title":"Connection String","description":"SQLAlchemy connection string"}},"type":"object","required":["connection_string"],"title":"TestConnectionRequest","description":"Request model for testing connection"},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token","description":"JWT access token"},"refresh_token":{"type":"string","title":"Refresh Token","description":"JWT refresh token"},"token_type":{"type":"string","title":"Token Type","description":"Token type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In","description":"Access token expiry in seconds"}},"type":"object","required":["access_token","refresh_token","expires_in"],"title":"TokenResponse","description":"Response schema for token-based authentication","example":{"access_token":"eyJhbGciOiJIUzI1NiIs...","expires_in":1800,"refresh_token":"eyJhbGciOiJIUzI1NiIs...","token_type":"bearer"}},"UserRegistrationRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User's email address"},"password":{"type":"string","maxLength":128,"minLength":8,"title":"Password","description":"Password (min 8 characters)"},"full_name":{"type":"string","maxLength":255,"minLength":2,"title":"Full Name","description":"User's full name"},"role":{"type":"string","title":"Role","description":"User role (admin, manager, user, viewer)","default":"user"}},"type":"object","required":["email","password","full_name"],"title":"UserRegistrationRequest","description":"Request schema for registering a new user within a tenant","example":{"email":"newuser@acme.com","full_name":"Jane Doe","password":"SecurePass123!","role":"user"}},"UserResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"email":{"type":"string","title":"Email"},"full_name":{"type":"string","title":"Full Name"},"role":{"type":"string","title":"Role"},"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"is_active":{"type":"boolean","title":"Is Active","default":true},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At"},"last_login":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login"}},"type":"object","required":["id","email","full_name","role","tenant_id"],"title":"UserResponse","description":"Response schema for user information","example":{"created_at":"2024-01-15T10:30:00Z","email":"admin@acme.com","full_name":"John Smith","id":"550e8400-e29b-41d4-a716-446655440000","is_active":true,"last_login":"2024-01-20T14:45:00Z","role":"owner","tenant_id":"123e4567-e89b-12d3-a456-426614174000"}},"UserUpdateRequest":{"properties":{"full_name":{"anyOf":[{"type":"string","maxLength":255,"minLength":2},{"type":"null"}],"title":"Full Name"},"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email"}},"type":"object","title":"UserUpdateRequest","description":"Request schema for updating user profile","example":{"email":"newemail@acme.com","full_name":"John Smith Updated"}},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"JWT":{"type":"http","description":"Enter your JWT access token","scheme":"bearer"}}}}